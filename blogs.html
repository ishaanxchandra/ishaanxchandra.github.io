<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Blogs - Ishaan Chandra</title>
    <meta name="description" content="Blogs by Ishaan Chandra">
    <meta name="keywords" content="Ishaan Chandra, Blog, Software Engineering, AI, Machine Learning">

    <!-- Fonts and Bootstrap CSS -->
    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&family=Poppins&family=Raleway&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/css/main.css" rel="stylesheet">
</head>

<style>
    .markdown-content h1, .markdown-content h2, .markdown-content h3, .markdown-content h4, .markdown-content h5, .markdown-content h6 {
        color: #00ff88;
    }
    .markdown-content p, .markdown-content ul, .markdown-content ol {
        color: #fff;
        margin: 5px 0;
    }
    .markdown-content code {
        background-color: #333;
        color: #00ff88;
        padding: 2px 4px;
        border-radius: 3px;
    }
    .markdown-content pre {
        background-color: #333;
        color: #00ff88;
        padding: 10px;
        border-radius: 5px;
        overflow-x: auto;
    }
    .spinner-border {
        width: 3rem;
        height: 3rem;
    }
    </style>
    

<body class="resume-page">

    <!-- Header -->
    <header id="header" class="header d-flex align-items-center fixed-top">
        <div class="container-fluid container-xl position-relative d-flex align-items-center justify-content-between">
          <a href="index.html" class="logo d-flex align-items-center">
            <h1 class="sitename">Ishaan Chandra</h1>
          </a>
          <nav id="navmenu" class="navmenu">
            <ul>
              <li><a href="index.html">Home</a></li>
              <li><a href="about.html">About</a></li>
              <li><a href="resume.html" >Resume</a></li>
              <li><a href="blogs.html" class="active">Blogs</a></li>
              <li><a href="portfolio.html">Portfolio</a></li>
              <li><a href="contact.html">Contact</a></li>
            </ul>
            <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
          </nav>
        </div>
      </header>


      <main class="main">
        <div class="page-title" data-aos="fade">
          <div class="heading">
            <div class="container">
              <div class="row d-flex justify-content-center text-center">
                <div class="col-lg-8">
                  <h1>Blogs</h1>
                  <p class="mb-0">Sharing insights, ideas, and experiences in software engineering and AI.</p>
                </div>
              </div>
            </div>
          </div>
          <nav class="breadcrumbs">
            <div class="container">
              <ol>
                <li><a href="index.html">Home</a></li>
                <li class="current">Blogs</li>
              </ol>
            </div>
          </nav>
        </div>
    
      </main>

    <main class="main" style="margin-top: 80px;">


        <!-- Login or Visitor Choice -->
        <section id="login-section" class="section">
            <div class="container" data-aos="fade-up">
                <div class="row justify-content-center">
                    <div class="col-lg-6 text-center">
                        <h3>Login or Continue as Visitor</h3>
                        <button onclick="continueAsVisitor()" class="btn btn-success w-50" style="margin-top: 1rem;">Continue as Visitor</button>
                        <div class="card p-4 shadow-sm" style="background-color: #000000;">
                            <h3>Login to Manage Posts</h3>
                            <input type="email" id="email" placeholder="Email" class="form-control mb-2">
                            <input type="password" id="password" placeholder="Password" class="form-control mb-2">
                            <button onclick="login()" class="btn btn-success w-100">Login</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Blog Editor -->
        <section id="blog-editor" class="section" style="display:none;">
            <div class="container" data-aos="fade-up">
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <h2>Blog Editor</h2>
                        <button onclick="logout()" class="btn btn-danger mb-3">Logout</button>
                        <div class="card p-4 shadow-sm">
                            <input type="text" id="blogTitle" placeholder="Blog Title" class="form-control mb-2" style="font-size: 1.2rem;">
                            <textarea id="blogContent" placeholder="Write your content..." class="form-control mb-2" rows="8" style="font-size: 1.1rem;"></textarea>
                            <button onclick="addPost()" class="btn btn-success w-100">Add Blog</button>
                        </div>
                        <!-- Editor-specific blog posts container -->
                        <div id="editorBlogPosts" class="mt-4"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Blog Visitor View -->
        <section id="blog-visitor" class="section" style="display:none;">
            <div class="container" data-aos="fade-up">
                <div class="row justify-content-center">
                    <div class="col-lg-6 text-center">
                        <h2>Blog Posts</h2>
                        <!-- Loading Spinner -->
                            <div id="loadingSpinner" class="text-center my-3" style="display: none;">
                                <div class="spinner-border text-light" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p style="color: #fff;">Loading blog posts...</p>
                            </div>
                        <!-- Visitor-specific blog posts container -->
                        <div id="visitorBlogPosts" class="mt-3"></div>
                        <button onclick="backToLogin()" class="btn btn-secondary mt-3">Back to Login</button>
                    </div>
                </div>
            </div>
        </section>


    </main>

    <!-- Footer -->
    <footer id="footer" class="footer dark-background">
        <div class="container">
          <h3 class="sitename">Ishaan Chandra</h3>
          <p>Connect with me on LinkedIn and GitHub.</p>
          <div class="social-links d-flex justify-content-center">
            <a href="https://www.facebook.com/chandra.ishaan"><i class="bi bi-facebook"></i></a>
            <a href="https://www.instagram.com/ishaan.chandra/"><i class="bi bi-instagram"></i></a>
            <a href="htwww.linkedin.com/in/ishaan-chandra-066243226"><i class="bi bi-linkedin"></i></a>
            <a href="https://github.com/ishaanxchandra"><i class="bi bi-github"></i></a>
          </div>
          <div class="container">
            <div class="copyright">
              <span>Copyright</span> <strong class="px-1 sitename">Ishaan Chandra</strong> <span>All Rights Reserved</span>
            </div>
            <div class="credits">
              Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
            </div>
          </div>
        </div>
      </footer>
    

    <!-- Firebase Script -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
        import { getDatabase, ref, push, set, onValue, remove } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-database.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
    
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDQA5Xjm6pRjYx9dl0ZvmZGZQA7P0F4mZ4",
            authDomain: "personal-wesbite-b4ec5.firebaseapp.com",
            databaseURL: "https://personal-wesbite-b4ec5-default-rtdb.firebaseio.com",
            projectId: "personal-wesbite-b4ec5",
            storageBucket: "personal-wesbite-b4ec5.appspot.com",
            messagingSenderId: "624660196094",
            appId: "1:624660196094:web:4f3a06bd8fa0ee7afd93af",
            measurementId: "G-JPRTVEDSG9"
        };
    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth(app);
        const dbRef = ref(database, 'blogs/');
    
        // Display Login or Visitor options on load
        // Display Login or Visitor options on load
        window.onload = function() {
            document.getElementById("login-section").style.display = "block";
            document.getElementById("blog-editor").style.display = "none";
            document.getElementById("blog-visitor").style.display = "none";
            // Fetch posts on load to ensure latest data
            //fetchPosts(true);  // Load visitor posts by default
        };

    
        // Authentication State Listener
        onAuthStateChanged(auth, (user) => {
            if (user) {
                showBlogEditor();
            }
        });
    
        // Login function
        window.login = function() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
    
            signInWithEmailAndPassword(auth, email, password)
                .then(() => {
                    alert('Login successful');
                    showBlogEditor();
                })
                .catch((error) => {
                    alert('Login failed: ' + error.message);
                });
        };
    
        // Logout function
        // Logout function
        window.logout = function() {
            signOut(auth).then(() => {
                alert('Logged out');
                // Clear the email and password fields
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
                showLoginView();
            });
        };

    
        // Continue as Visitor function
        window.continueAsVisitor = function() {
            showVisitorView();
        };
    
        // Back to Login function from Visitor View
        window.backToLogin = function() {
            showLoginView();
            window.location.href = "blogs.html"; // Redirect to the Blogs page
        };
    
        // Fetch and display blog posts
        // Add a new blog post
        // Add a new blog post
        // Add a new blog post
        // Add a new blog post
        // Add a new blog post
        // Add a new blog post
        // Add a new blog post with Markdown content
        window.addPost = function() {
            const title = document.getElementById('blogTitle').value;
            const content = document.getElementById('blogContent').value;

            if (title && content) {
                const date = new Date();
                const timestamp = date.toLocaleString(); // Format: MM/DD/YYYY, HH:MM:SS

                const newPostRef = push(dbRef);
                set(newPostRef, { title, content, timestamp })
                    .then(() => {
                        alert('Blog post added!');
                        // Clear the fields after submission
                        document.getElementById('blogTitle').value = '';
                        document.getElementById('blogContent').value = '';
                        // Update both the editor and visitor views
                        fetchPosts();    // Update the editor view
                        fetchPosts(true); // Update the visitor view
                    })
                    .catch((error) => {
                        console.error('Error adding post:', error);
                    });
            } else {
                alert('Title and content cannot be empty.');
            }
        };





        // Fetch and display blog posts
        // Fetch and display blog posts
        // Fetch and display blog posts
        // Fetch and display blog posts
        // Fetch and display blog posts
        // Fetch and display blog posts with Markdown support
        // Fetch and display blog posts with loading spinner
        function fetchPosts(viewOnly = false) {
            const blogContainer = viewOnly ? document.getElementById('visitorBlogPosts') : document.getElementById('editorBlogPosts');
            const loadingSpinner = document.getElementById('loadingSpinner');

            // Show the spinner before fetching
            loadingSpinner.style.display = 'block';
            blogContainer.innerHTML = '';

            onValue(dbRef, (snapshot) => {
                if (snapshot.exists()) {
                    const posts = snapshot.val();
                    console.log("Fetched posts:", posts); // Log to see the data being retrieved

                    // Hide spinner after fetching data
                    loadingSpinner.style.display = 'none';

                    if (posts) {
                        Object.keys(posts).forEach((id) => {
                            const post = posts[id];
                            const postElement = document.createElement('div');
                            postElement.className = 'blog-post mb-3 p-3 border rounded';
                            postElement.style.backgroundColor = "#000";
                            postElement.style.color = "#fff";
                            postElement.style.cursor = "pointer";
                            postElement.style.transition = "all 0.3s ease";

                            // Create a unique ID for the content div
                            const contentId = `content-${id}`;

                            // Click to expand content
                            postElement.onclick = function() {
                                const contentDiv = document.getElementById(contentId);
                                if (contentDiv.style.display === "none" || contentDiv.style.display === "") {
                                    contentDiv.style.display = "block";
                                } else {
                                    contentDiv.style.display = "none";
                                }
                            };

                            // Render the markdown content using marked.js
                            const markdownContent = marked.parse(post.content);

                            postElement.innerHTML = `
                                <h4>${post.title}</h4>
                                <small>${post.timestamp}</small>
                                <div id="${contentId}" style="display: none; margin-top: 10px;">
                                    <div class="markdown-content">${markdownContent}</div>
                                </div>
                                ${!viewOnly ? `<button class="btn btn-danger mt-2" onclick="deletePost('${id}')">Delete</button>` : ''}
                            `;
                            blogContainer.appendChild(postElement);
                        });
                    } else {
                        blogContainer.innerHTML = '<p style="color: #fff;">No blog posts available.</p>';
                    }
                } else {
                    loadingSpinner.style.display = 'none'; // Hide spinner if no data
                    blogContainer.innerHTML = '<p style="color: #fff;">No blog posts available.</p>';
                }
            }, (error) => {
                console.error("Error fetching posts:", error);
                loadingSpinner.style.display = 'none'; // Hide spinner if error
                blogContainer.innerHTML = '<p style="color: #fff;">Failed to load blog posts. Please try again later.</p>';
            });
        }




    
        // Delete a blog post
        window.deletePost = function(id) {
            const postRef = ref(database, 'blogs/' + id);
            remove(postRef)
                .then(() => {
                    alert('Blog post deleted!');
                    fetchPosts();
                })
                .catch((error) => {
                    console.error('Error deleting post:', error);
                });
        };
    
        // Show Blog Editor for Authenticated User
        function showBlogEditor() {
            document.getElementById("login-section").style.display = "none";
            document.getElementById("blog-editor").style.display = "block";
            document.getElementById("blog-visitor").style.display = "none";
            fetchPosts();
        }
    
        // Show Visitor View
        // Show Visitor View
        // Show Visitor View
        function showVisitorView() {
            document.getElementById("login-section").style.display = "none";
            document.getElementById("blog-visitor").style.display = "block";
            fetchPosts(true);  // Ensure visitor view is always updated
        }


    
        // Show Login View
        function showLoginView() {
            document.getElementById("login-section").style.display = "block";
            document.getElementById("blog-editor").style.display = "none";
            document.getElementById("blog-visitor").style.display = "none";
        }
    </script>
    
</body>
<script src="assets/js/main.js"></script>

</html>
